#include <stdio.h>
#define MAX 200005

int position[MAX];

int left_ptr = 100000;
int right_ptr = 100001;

void insert_left(int id) {
    left_ptr--;
    position[id] = left_ptr;
}

void insert_right(int id) {
    position[id] = right_ptr;
    right_ptr++;
}

void query(int id) {
    int left_distance = position[id] - left_ptr;
    int right_distance = right_ptr - position[id] - 1;
    int min = (left_distance < right_distance) ? left_distance : right_distance;
    printf("%d\n", min);
}

int main() {
    int q;
    scanf("%d", &q);

    for (int i = 0; i < q; ++i) {
        char type;
        int id;
        scanf(" %c %d", &type, &id);

        if (type == 'L') {
            insert_left(id);
        } else if (type == 'R') {
            insert_right(id);
        } else if (type == '?') {
            query(id);
        }
    }

    return 0;
}

