#include <stdio.h>
#define MOD 998244353LL
#define MAXN 200005

typedef long long ll;

ll fact[MAXN];

ll power(ll a, ll b) {
    ll res = 1;
    while (b) {
        if (b & 1) res = res * a % MOD;
        a = a * a % MOD;
        b >>= 1;
    }
    return res;
}

void solve() {
    int n;
    scanf("%d", &n);
    ll max1 = 0, max2 = 0;
    int cntMax1 = 0, cntMax2 = 0;

    for (int i = 0; i < n; i++) {
        ll x; scanf("%lld", &x);

        if (x > max1) {
            max2 = max1; cntMax2 = cntMax1;
            max1 = x; cntMax1 = 1;
        } else if (x == max1) {
            cntMax1++;
        } else if (x > max2) {
            max2 = x; cntMax2 = 1;
        } else if (x == max2) {
            cntMax2++;
        }
    }

    if (cntMax1 >= 2) {
        printf("%lld\n", fact[n]);
        return;
    }

    if (max1 - max2 >= 2) {
        printf("0\n");
        return;
    }

    ll inv = power(cntMax2 + 1, MOD - 2);
    ll sub = fact[n] * inv % MOD;
    ll ans = (fact[n] - sub + MOD) % MOD;
    printf("%lld\n", ans);
}

int main() {
    fact[0] = 1;
    for (int i = 1; i < MAXN; i++) fact[i] = fact[i-1] * i % MOD;

    int t; scanf("%d", &t);
    while (t--) solve();
    return 0;
}

