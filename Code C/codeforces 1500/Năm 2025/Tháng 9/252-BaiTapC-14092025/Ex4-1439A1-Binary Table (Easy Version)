#include <stdio.h>
#include <string.h>

typedef struct {
    int x1,y1,x2,y2,x3,y3;
} Step;

Step ans[70000];
int n,m,a[105][105], cnt;

void add(int x1,int y1,int x2,int y2,int x3,int y3){
    ans[cnt++] = (Step){x1,y1,x2,y2,x3,y3};
    a[x1][y1]^=1; a[x2][y2]^=1; a[x3][y3]^=1;
}

void fix(int r,int c){
    while(1){
        int one[4][2], zero[4][2], o=0,z=0;
        int cell[4][2]={{r,c},{r,c+1},{r+1,c},{r+1,c+1}};
        for(int i=0;i<4;i++){
            int x=cell[i][0],y=cell[i][1];
            if(a[x][y]){one[o][0]=x; one[o++][1]=y;}
            else {zero[z][0]=x; zero[z++][1]=y;}
        }
        if(o==0) break;
        if(o>=3) add(one[0][0],one[0][1],one[1][0],one[1][1],one[2][0],one[2][1]);
        else if(o==2) add(one[0][0],one[0][1],one[1][0],one[1][1],zero[0][0],zero[0][1]);
        else add(one[0][0],one[0][1],zero[0][0],zero[0][1],zero[1][0],zero[1][1]);
    }
}

int main(){
    int T; scanf("%d",&T);
    while(T--){
        scanf("%d%d",&n,&m);
        char s[105];
        for(int i=1;i<=n;i++){
            scanf("%s",s);
            for(int j=1;j<=m;j++) a[i][j]=s[j-1]-'0';
        }
        cnt=0;
        for(int i=1;i<=n-2;i++)
            for(int j=1;j<=m;j++)
                if(a[i][j])
                    j<m ? add(i,j,i+1,j,i+1,j+1)
                        : add(i,j,i+1,j,i+1,j-1);
        for(int j=1;j<=m-2;j++){
            if(a[n-1][j]&&a[n][j]) add(n-1,j,n,j,n-1,j+1);
            else if(a[n-1][j])     add(n-1,j,n-1,j+1,n,j+1);
            else if(a[n][j])       add(n,j,n-1,j+1,n,j+1);
        }
        fix(n-1,m-1);
        printf("%d\n",cnt);
        for(int i=0;i<cnt;i++)
            printf("%d %d %d %d %d %d\n",
                   ans[i].x1,ans[i].y1,
                   ans[i].x2,ans[i].y2,
                   ans[i].x3,ans[i].y3);
    }
    return 0;
}

