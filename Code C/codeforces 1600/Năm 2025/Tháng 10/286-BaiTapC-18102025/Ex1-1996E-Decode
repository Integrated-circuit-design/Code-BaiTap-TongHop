#include <stdio.h>
#include <string.h>

#define MAXN 200005
#define MOD 1000000007
#define OFFSET MAXN

typedef long long ll;

static int pos[2 * MAXN][2];
static int cnt[2 * MAXN];
static int last[2 * MAXN];
static int seen[2 * MAXN];

int main() {
    int t;
    scanf("%d", &t);

    while (t--) {
        char s[MAXN];
        scanf("%s", s);
        int n = strlen(s);

        for (int i = 0; i < 2 * MAXN; i++) {
            if (seen[i]) {
                cnt[i] = 0;
                last[i] = 0;
                pos[i][0] = pos[i][1] = 0;
                seen[i] = 0;
            }
        }

        ll ans = 0;
        int cur = OFFSET;

        seen[cur] = 1;
        cnt[cur] = 1;
        last[cur] = 0;

        for (int i = 0; i < n; i++) {
            if (s[i] == '1') cur++;
            else cur--;

            seen[cur] = 1;
            int num = cnt[cur];
            ll sumPos = last[cur];

            ll add = ((ll)(i + 2) * (n - i) % MOD) * sumPos % MOD;
            ans = (ans + add) % MOD;

            cnt[cur]++;
            last[cur] = (last[cur] + i + 1) % MOD;
        }

        printf("%lld\n", ans % MOD);
    }
    return 0;
}

