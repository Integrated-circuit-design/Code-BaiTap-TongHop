#include <stdio.h>

#define MAXN 200005

int a[MAXN], b[MAXN], used[MAXN], who[MAXN];

int main() {
    int t;
    scanf("%d", &t);

    while (t--) {
        int n;
        scanf("%d", &n);

        for (int i = 1; i <= n; i++) {
            scanf("%d", &a[i]);
            used[i] = 0;
            b[i] = 0;
            who[i] = 0;
        }

        int happy = 0;
        for (int i = 1; i <= n; i++) {
            if (!used[a[i]]) {
                b[i] = a[i];
                used[a[i]] = 1;
                who[a[i]] = i;
                happy++;
            }
        }

        int un = 0;
        for (int i = 1; i <= n; i++) {
            if (!b[i]) un++;
        }

        int last_free = 0;
        for (int i = 1; i <= n; i++) {
            if (!b[i]) {
                for (int j = 1; j <= n; j++) {
                    if (!used[j] && j != i) {
                        b[i] = j;
                        used[j] = 1;
                        break;
                    }
                }
                if (!b[i]) last_free = i;
            }
        }

        if (last_free) {
            for (int i = 1; i <= n; i++) {
                if (b[i] != a[i] && i != last_free && b[i] != last_free) {
                    int temp = b[i];
                    b[i] = last_free;
                    b[last_free] = temp;
                    break;
                }
            }
        }

        happy = 0;
        for (int i = 1; i <= n; i++)
            if (b[i] == a[i]) happy++;

        printf("%d\n", happy);
        for (int i = 1; i <= n; i++)
            printf("%d%c", b[i], (i == n ? '\n' : ' '));
    }
    return 0;
}

