#include <stdio.h>
#include <stdlib.h>

typedef long long ll;

typedef struct {
    int u, v;
    ll w;
} Edge;

int main() {
    int t;
    scanf("%d", &t);

    while (t--) {
        int n, m;
        scanf("%d %d", &n, &m);

        Edge *edges = (Edge*)malloc(sizeof(Edge) * m);
        ll *a = (ll*)malloc(sizeof(ll) * (n + 1));
        for (int i = 1; i <= n; i++) a[i] = 0;

        for (int i = 0; i < m; i++) {
            scanf("%d %d %lld", &edges[i].u, &edges[i].v, &edges[i].w);
        }

        int ok = 1;
        for (int i = 0; i < m; i++) {
            int u = edges[i].u;
            int v = edges[i].v;
            ll w = edges[i].w;

            if (a[u] == 0 && a[v] == 0) {
                a[u] = w;
                a[v] = w;
            } else if (a[u] == 0) {
                if (w > a[v]) a[u] = w;
                else a[u] = w;
            } else if (a[v] == 0) {
                if (w > a[u]) a[v] = w;
                else a[v] = w;
            } else {
                ll min_val = (a[u] < a[v]) ? a[u] : a[v];
                if (min_val != w) {
                    ok = 0;
                    break;
                }
            }
        }

        if (!ok) {
            printf("NO\n");
        } else {
            printf("YES\n");
            for (int i = 1; i <= n; i++) {
                printf("%lld%c", a[i], (i == n) ? '\n' : ' ');
            }
        }

        free(edges);
        free(a);
    }

    return 0;
}

