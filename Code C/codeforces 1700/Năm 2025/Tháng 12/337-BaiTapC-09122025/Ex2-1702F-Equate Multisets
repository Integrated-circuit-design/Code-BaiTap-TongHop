#include <stdio.h>
#include <stdlib.h>

typedef long long ll;

int cmp_ll(const void *x, const void *y){
    ll a = *(ll*)x, b = *(ll*)y;
    if(a < b) return -1;
    if(a > b) return 1;
    return 0;
}

int main(){
    int t;
    scanf("%d", &t);

    while(t--){
        int n;
        scanf("%d", &n);

        static ll a[200000], b[200000];

        for(int i = 0; i < n; i++) scanf("%lld", &a[i]);
        for(int i = 0; i < n; i++) scanf("%lld", &b[i]);

        qsort(a, n, sizeof(ll), cmp_ll);
        qsort(b, n, sizeof(ll), cmp_ll);

        int cur = n - 1;
        int ok = 1;

        for(int i = n - 1; i >= 0; i--){
            ll x = b[i];
            while(x > 0 && (cur >= 0) && x > a[cur]){
                x >>= 1;
            }
            if(cur >= 0 && x == a[cur]){
                cur--;
            }
            else{
                ok = 0;
                break;
            }
        }

        printf(ok ? "YES\n" : "NO\n");
    }

    return 0;
}

